<!doctype html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: April 12, 2025 --><html lang="en-us" dir="ltr"
      data-wc-theme-default="auto">
  
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="generator" content="Hugo Blox Builder 0.3.1" />

  
  












  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Francis L. Huang" />

  
  
  
    
  
  <meta name="description" content="Using FIML in R with Multilevel Data (Part 3) A recurring question that I get asked is how to use full information maximum likelihood (FIML) when performing a multiple regression analysis BUT this time, accounting for nesting or clustered data structure. For this example, I use the the leadership dataset in the mitml package (Grund et al., 2021). We&rsquo;ll also use lavaan (Roseel, 2012) to estimate the two-level model. The chapter of Grund et al. (2019) is available here. We&rsquo;ll replicate the Mplus FIML results in Table 16.3 in the chapter and is shown below:
" />

  
  <link rel="alternate" hreflang="en-us" href="http://localhost:1313/post/mi_pt3/" />

  
  
  
  
    
    <link rel="stylesheet" href="/css/themes/blue.min.css" />
  

  
  
    
    <link href="/dist/wc.min.css" rel="stylesheet" />
  

  
  
  

  

  <script>
     
    window.hbb = {
       defaultTheme: document.documentElement.dataset.wcThemeDefault,
       setDarkTheme: () => {
        document.documentElement.classList.add("dark");
        document.documentElement.style.colorScheme = "dark";
      },
       setLightTheme: () => {
        document.documentElement.classList.remove("dark");
        document.documentElement.style.colorScheme = "light";
      }
    }

    console.debug(`Default Hugo Blox Builder theme is ${window.hbb.defaultTheme}`);

    if ("wc-color-theme" in localStorage) {
      localStorage.getItem("wc-color-theme") === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
    } else {
      window.hbb.defaultTheme === "dark" ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      if (window.hbb.defaultTheme === "system") {
        window.matchMedia("(prefers-color-scheme: dark)").matches ? window.hbb.setDarkTheme() : window.hbb.setLightTheme();
      }
    }
  </script>

  <script>
    
    document.addEventListener('DOMContentLoaded', function () {
      
      let checkboxes = document.querySelectorAll('li input[type=\'checkbox\'][disabled]');
      checkboxes.forEach(e => {
        e.parentElement.parentElement.classList.add('task-list');
      });

      
      const liNodes = document.querySelectorAll('.task-list li');
      liNodes.forEach(nodes => {
        let textNodes = Array.from(nodes.childNodes).filter(node => node.nodeType === 3 && node.textContent.trim().length > 1);
        if (textNodes.length > 0) {
          const span = document.createElement('label');
          textNodes[0].after(span);  
          span.appendChild(nodes.querySelector('input[type=\'checkbox\']'));
          span.appendChild(textNodes[0]);
        }
      });
    });
  </script>

  
  
  




































  
  

  
  <link rel="icon" type="image/png" href="/media/icon_hu_3a05525e284cb133.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu_f701646b16bb8941.png" />

  <link rel="canonical" href="http://localhost:1313/post/mi_pt3/" />

  
  
  
  
  
  
  
  
    
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary" />
  
    <meta property="twitter:site" content="@flhuang" />
    <meta property="twitter:creator" content="@flhuang" />
  
  <meta property="og:site_name" content="FLH Website" />
  <meta property="og:url" content="http://localhost:1313/post/mi_pt3/" />
  <meta property="og:title" content="Using FIML in R for Multilevel Data | FLH Website" />
  <meta property="og:description" content="Using FIML in R with Multilevel Data (Part 3)
A recurring question that I get asked is how to use full information maximum likelihood (FIML) when performing a multiple regression analysis BUT this time, accounting for nesting or clustered data structure. For this example, I use the the leadership dataset in the mitml package (Grund et al., 2021). We&rsquo;ll also use lavaan (Roseel, 2012) to estimate the two-level model. The chapter of Grund et al. (2019) is available here. We&rsquo;ll replicate the Mplus FIML results in Table 16.3 in the chapter and is shown below:" /><meta property="og:image" content="http://localhost:1313/media/icon_hu_7c4bcaa7031a3f50.png" />
    <meta property="twitter:image" content="http://localhost:1313/media/icon_hu_7c4bcaa7031a3f50.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2022-06-01T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2022-06-01T00:00:00&#43;00:00">
  

  



  


  <title>Using FIML in R for Multilevel Data | FLH Website</title>

  
  
  
  
  
    
    
  
  
  <style>
    @font-face {
      font-family: 'Inter var';
      font-style: normal;
      font-weight: 100 900;
      font-display: swap;
      src: url(/dist/font/Inter.var.woff2) format(woff2);
    }
  </style>

  

  
  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
      
      
    
      
      
        
        
          
        
          
        
          
        
          
        
          
        
        
        
      
    
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  







<link type="text/css" rel="stylesheet" href="/dist/pagefind/pagefind-ui.be766eb419317a14ec769d216e9779bfe8f3737c80e780f4ba0dafb57a41a482.css" integrity="sha256-vnZutBkxehTsdp0hbpd5v&#43;jzc3yA54D0ug2vtXpBpII=" />


<script src="/dist/pagefind/pagefind-ui.87693d7c6f2b3b347ce359d0ede762c033419f0a32b22ce508c335a81d841f1b.js" integrity="sha256-h2k9fG8rOzR841nQ7ediwDNBnwoysizlCMM1qB2EHxs="></script>


<script>window.hbb.pagefind = {"baseUrl":"/"};</script>

<style>
  html.dark {
    --pagefind-ui-primary: #eeeeee;
    --pagefind-ui-text: #eeeeee;
    --pagefind-ui-background: #152028;
    --pagefind-ui-border: #152028;
    --pagefind-ui-tag: #152028;
  }
</style>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    new PagefindUI({
      element: "#search",
      showSubResults: true,
      baseUrl: window.hbb.pagefind.baseUrl,
      bundlePath: window.hbb.pagefind.baseUrl + "pagefind/",
    });
  });
  document.addEventListener('DOMContentLoaded', () => {
    let element = document.getElementById('search');
    let trigger = document.getElementById('search_toggle');

    if (trigger) {
      trigger.addEventListener('click', () => {
        element.classList.toggle('hidden');
        element.querySelector("input").value = ""
        element.querySelector("input").focus()

        if (!element.classList.contains('hidden')) {
          let clear_trigger = document.querySelector('.pagefind-ui__search-clear');

          if (clear_trigger && !clear_trigger.hasAttribute('listenerOnClick')) {
            clear_trigger.setAttribute('listenerOnClick', 'true');

            clear_trigger.addEventListener('click', () => {
              element.classList.toggle('hidden');
            });
          }
        }

      });
    }
  });
</script>










  
  
  <link type="text/css" rel="stylesheet" href="/dist/lib/katex/katex.min.505d5f829022bb7b4f24dfee0aa1141cd7bba67afe411d1240335f820960b5c3.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr&#43;QR0SQDNfgglgtcM=" />
  
  
  <script defer src="/dist/lib/katex/katex.min.dc84b296ec3e884de093158f760fd9d45b6c7abe58b5381557f4e138f46a58ae.js" integrity="sha256-3ISyluw&#43;iE3gkxWPdg/Z1Ftser5YtTgVV/ThOPRqWK4="></script>
  
  
  
  
  <script defer src="/js/katex-renderer.6579ec9683211cfb952064aedf3a3baea5eeb17a061775b32b70917474637c80.js" integrity="sha256-ZXnsloMhHPuVIGSu3zo7rqXusXoGF3WzK3CRdHRjfIA="></script>
  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  






  
  
  
  
  
  
  
  <script
    defer
    src="/js/hugo-blox-en.min.js"
    integrity=""
  ></script>

  
  








  
    
      
      <script async defer src="https://buttons.github.io/buttons.js"></script>

      
    
  




</head>

  <body class="dark:bg-hb-dark dark:text-white page-wrapper" id="top">
    <div id="page-bg"></div>
    <div class="page-header sticky top-0 z-30">
      
      
      
        
        
        
          <header id="site-header" class="header">
  <nav class="navbar px-3 flex justify-left">
    <div class="order-0 h-100">
      
      <a class="navbar-brand" href="/" title="FLH Website">
        Francis L. Huang
      </a>
    </div>
    
    <input id="nav-toggle" type="checkbox" class="hidden" />
    <label
      for="nav-toggle"
      class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1">
      <svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20">
        <title>Open Menu</title>
        <path d="M0 3h20v2H0V3z m0 6h20v2H0V9z m0 6h20v2H0V0z"></path>
      </svg>
      <svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20">
        <title>Close Menu</title>
        <polygon
          points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2"
          transform="rotate(45 10 10)"></polygon>
      </svg>
    </label>
    

    
    
    <ul
      id="nav-menu"
      class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8 justify-left
      ">
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/#talks"
        >Talks</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/#news"
        >Posts</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/MLMusingR/"
        >MLMusingR</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/projects/"
        >Projects</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/teaching/"
        >Teaching</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="/service/"
        >Service</a
        >
      </li>
      
      
      
      
      
      
      <li class="nav-item nav-dropdown group relative">
            <span
              class="nav-link 
                
                
                
              
                
                
                
               inline-flex items-center">
              Research
              <svg class="h-4 w-4 fill-current inline-block" viewBox="0 0 20 20">
                <path
                  d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z" />
              </svg>
            </span>
        <ul
          class="nav-dropdown-list lg:group-hover:visible lg:group-hover:opacity-100">
          
          
          
          <li class="nav-dropdown-item">
            <a
              class="nav-dropdown-link "
              
              href="/#papers">
              Papers
            </a>
          </li>
          
          
          
          <li class="nav-dropdown-item">
            <a
              class="nav-dropdown-link "
              
              href="/r">
              R Packages
            </a>
          </li>
          
        </ul>
      </li>
      
      
      
    </ul>

    <div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0">

      
      
      
      <button
        aria-label="search"
        class="text-black hover:text-primary  inline-block px-3 text-xl dark:text-white"
        id="search_toggle">
        <svg xmlns="http://www.w3.org/2000/svg" height="16" width="16" viewBox="0 0 512 512" fill="currentColor"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg>
      </button>
      

      
      
      <div class="px-3 text-black hover:text-primary-700 dark:text-white dark:hover:text-primary-300
            [&.active]:font-bold [&.active]:text-black/90 dark:[&.active]:text-white">
        <button class="theme-toggle mt-1" accesskey="t" title="appearance">
          <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class="dark:hidden">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
          <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
               fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
               stroke-linejoin="round" class=" dark:block [&:not(dark)]:hidden">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>
      </div>
      

      
      

      
      
    </div>
  </nav>
</header>


<div id="search" class="hidden p-3"></div>


        
      
    </div>
    <div class="page-body  my-10">
      





<div class="mx-auto flex max-w-screen-xl">
  



<aside class="hb-sidebar-container max-lg:[transform:translate3d(0,-100%,0)] lg:hidden xl:block">
  
  <div class="px-4 pt-4 lg:hidden">
    
    
  </div>
  <div class="hb-scrollbar lg:h-[calc(100vh-var(--navbar-height))]">
    <ul class="flex flex-col gap-1 lg:hidden">
      
      
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/"
    
  >Publications
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2025/lsa-weights/"
    
  >Reassessing weights in large-scale assessments and multilevel models
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2025/cornell-behavioral-2025/"
    
  >Behavioral threat assessment and equity in exclusionary school discipline
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2025/huang-cluster-robust-2025/"
    
  >Cluster-robust standard errors with three-level data
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2025/cornell-referral-2025/"
    
  >Referral rates for school threat assessment
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/gregory-restorative-2025/"
    
  >Restorative justice conferences in elementary and secondary schools
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/jimerson-advancing-2024/"
    
  >Advancing diversity, equity, and inclusion in school psychology science and scholarship: Changing training and practice in the field of school psychology
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/chuang-potential-2022/"
    
  >Potential moderation across racial groups in perceptions of authoritative school climate and peer victimization and student engagement
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/huang-seasonality-2023/"
    
  >The seasonality of school climate
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/smith-school-2024/"
    
  >School bullying and gender minority youth: Victimization experiences and perceived prevalence
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/reinke-having-2024/"
    
  >Having a trusted adult in school: Concurrent and predictive relations with internalizing problems across development
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/eddy-positive-2024/"
    
  >Positive student-teacher relationships and exclusionary discipline practices
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/gregory-steadfast-2023/"
    
  >Steadfast implementation of restorative practices during the Covid-19 pandemic: A case study of consultancy and leadership in an elementary school
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/huang-replication-2024/"
    
  >Replication studies using secondary or nonexperimental datasets
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/huang-using-2024/"
    
  >Using plausible values when fitting multilevel models with large-scale assessment data using R
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/gregory-adolescent-2024/"
    
  >Adolescent exposure to restorative practices and their perceptions of support, structure, and bullying in the school climate
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2025/stemmler-investigating-2024/"
    
  >Investigating the use of robust standard errors to account for two-way clustering in cross-classified data structures
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/huang-impact-2023/"
    
  >The impact of restorative practices on the use of out-of-school suspensions: Results from a cluster randomized controlled trial
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/woods-relationship-2023/"
    
  >The relationship between teacher stress and job satisfaction as moderated by coping
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/herman-usability-2023/"
    
  >Usability and social consequences of the early identification system as a universal screener for social, emotional, and behavioral risks.
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/huang-accounting-2023/"
    
  >Accounting for heteroskedasticity resulting from between-group differences in multilevel models
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/wiedermann-advanced-2023/"
    
  >Advanced categorical data analysis in prevention science
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/cohen-school-2023/"
    
  >In-school and out-of-school suspension: Behavioral and psychological outcomes in a predominately black sample of middle school students
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/book/huang-practical-2023/"
    
  >Practical multilevel modeling using R
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/maeng-teacher-2023/"
    
  >Teacher Perceptions of School Resource Officers and Associations with School Safety
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/huang-using-2023/"
    
  >Using robust standard errors for the analysis of binary outcomes with a small number of clusters
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/gregory-evaluation-2022/"
    
  >Evaluation of the whole school restorative practices project: One-year impact on discipline incidents
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/olsen-interaction-2022/"
    
  >Interaction of socioeconomic status and class relations on reading
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/crichlow-ball-student-2022/"
    
  >Student perceptions of school resource officers and threat reporting
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/reinke-examining-2022/"
    
  >Examining the validity of the Early Identification System – Student Version for screening in an elementary school sample
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/huang-alternatives-2022/"
    
  >Alternatives to logistic regression models in experimental studies
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/huang-analyzing-2022/"
    
  >Analyzing cross-sectionally clustered data using generalized estimating equations
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/eddy-evaluation-2022/"
    
  >Evaluation of a bibliotherapy-based stress intervention for teachers
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/huang-using-2022/"
    
  >Using cluster-robust standard errors when analyzing group-randomized trials with few clusters
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/herman-individual-2021/"
    
  >Individual and school predictors of teacher stress, coping, and wellness during the COVID-19 pandemic
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/olsen-association-2021/"
    
  >The association between student socioeconomic status and student–teacher relationships on math achievement
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/huang-does-2021/"
    
  >Does worrying matter? Priming and attitudes towards mask wearing in a midwestern state
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/stohlman-high-2021/"
    
  >High school graduation outcomes of student threat assessment
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test3/jimerson-advancing-2021/"
    
  >Advancing diversity, equity, and inclusion in school psychology: Be the change
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2022/herman-investigation-2021/"
    
  >An investigation of the psychometric properties of the Early Identification System–student report in a middle school sample
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2020/huang-authoritative-2021/"
    
  >Authoritative school climate and out-of-school suspensions: Results from a nationally-representative survey of 10th grade students
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2020/thompson-confirmatory-2021/"
    
  >Confirmatory factor structure and predictive validity of the Early Identification System—Student Report in a community sample of high school students
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/huang-teacher-2021/"
    
  >Teacher support for zero tolerance is associated with higher suspension rates and lower feelings of safety
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/maeng-student-2020/"
    
  >Student threat assessment as an alternative to exclusionary discipline
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/jiv/huang-role-2017/"
    
  >The role of the perceptions of school climate and teacher victimization by students
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2020/eddy-does-2020/"
    
  >Does teacher emotional exhaustion and efficacy predict student discipline sanctions?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/huang-prior-2020/"
    
  >Prior problem behaviors do not account for the racial suspension gap
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2020/huang-manova-2020/"
    
  >MANOVA: A procedure whose time has passed?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2020/huang-relationship-2020/"
    
  >The relationship between school disciplinary resolutions with school climate and attitudes toward school
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/prewett-student-2019/"
    
  >Student and teacher perceptions on student-teacher relationship quality: A middle school perspective
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2019/huang-investigation-2019/"
    
  >An investigation of the psychometric properties of the Early Identification System–Student Report
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/huang-school-2019/"
    
  >School teasing and bullying after the presidential election
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/burnette-school-2019/"
    
  >School threat assessment versus suicide assessment: Statewide prevalence and case characteristics
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/olsen-teacher-2019/"
    
  >Teacher job satisfaction by principal support and teacher cooperation: Results from the Schools and Staffing Survey
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2019/smith-understanding-2019/"
    
  >Understanding family–school engagement across and within elementary- and middle-school contexts
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/huang-multilevel-2018-1/"
    
  >Multilevel modeling myths
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/huang-relationship-2018/"
    
  >The relationship of school climate with out-of-school suspensions
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/ford-effect-2018/"
    
  >The effect of orthographic complexity on Spanish spelling in Grades 1–3
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/gregory-examination-2018/"
    
  >An examination of restorative interventions and racial equity in out-of-school suspensions
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/huang-bullying-2018/"
    
  >Bullying involvement, teacher-student relationships, and psychosocial outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/huang-black-2018/"
    
  >Do Black students misbehave more? Investigating the differential involvement hypothesis and out-of-school suspensions
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/huang-multilevel-2018/"
    
  >Multilevel modeling and ordinary least squares regression:  How comparable are they?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/cornell-racialethnic-2018/"
    
  >Racial/ethnic parity in disciplinary consequences using student threat assessment
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/jia-impact-2018/"
    
  >The impact of validity screening on associations between self-reports of bullying victimization and student outcomes
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/huang-using-2018-1/"
    
  >Using cluster bootstrapping to analyze nested data with a few clusters
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/huang-using-2018/"
    
  >Using instrumental variable estimation to evaluate randomized experiments with imperfect compliance
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/bullying/datta-toxicity-2017/"
    
  >The toxicity of bullying by teachers and other school staff
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/cornell-student-2017/"
    
  >Student Threat Assessment as a Standard School Safety Practice: Results From a Statewide Implementation Study.
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/cornell-student-2017/"
    
  >Student Threat Assessment as a Standard School Safety Practice: Results From a Statewide Implementation Study.
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/huang-student-2017/"
    
  >Student attitudes and behaviors as explanations for the Black-White suspension gap
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/konold-racialethnic-2017/"
    
  >Racial/ethnic differences in perceptions of school climate and its association with student engagement and peer aggression
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/huang-question-2016/"
    
  >Question order affects the measurement of bullying victimization among middle school students
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/bullying/datta-aggressive-2016/"
    
  >Aggressive attitudes and prevalence of bullying bystander behavior in middle school
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/bullying/millspaugh-prevalence-2015/"
    
  >Prevalence of aggressive attitudes and willingness to report threats in middle school
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/cornell-school-2015/"
    
  >School counselor use of peer nominations to identify victims of bullying
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/rubie-davies-successive-2014/"
    
  >Successive teacher expectation effects across the early school years
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/gregory-it-2013/"
    
  >It takes a village: The effects of 10th grade college-going expectations of students, parents, and teachers four years later
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/test2/huang-differential-2012/"
    
  >The differential effects of preschool: Evidence from Virginia
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/huang-is-2009/"
    
  >Is experience the best teacher? A multilevel analysis of teacher characteristics and student achievement in low performing schools
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/publication/journal-article/2018/huang-corruption-2008/"
    
  >Corruption and educational outcomes: Two steps forward, one step back
    </a>
              
            </li></ul>
      </div></li>
        <li class="open"><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/"
    
  >Posts
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/weights_2025/"
    
  >Weights with Multilevel Models
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/jobs-2025/"
    
  >🎉 Job postings 2024-2025
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/pca-image/"
    
  >Fun with PCA using Images
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/2024_lsa/"
    
  >Selecting the proper weights in LSAs with multilevel models
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/pv3/"
    
  >Using Plausible Values with Multilevel Models Using R (update)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/pv/"
    
  >Using Plausible Values with Multilevel Models Using R
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/jobs-2024/"
    
  >🎉 Job postings 2023-2024
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/gd_example/"
    
  >Gradient descent example 1
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/logreg_matrix/"
    
  >🖩 Logistic regression with matrices
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/residuals_mlm/"
    
  >Residuals with Multilevel Models
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/jobs-2023/"
    
  >🎉 Job postings 2022-2023
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/residuals/"
    
  >Fun with residuals
    </a>
              
            </li><li class="flex flex-col open"><a
    class="hb-sidebar-custom-link
      sidebar-active-item bg-primary-100 font-semibold text-primary-800 dark:bg-primary-300 dark:text-primary-900"
    href="/post/mi_pt3/"
    
  >Using FIML in R for Multilevel Data
    </a>
  
    <ul class="hb-sidebar-mobile-toc"><li>
              <a
                href="#using-fiml-in-r-with-multilevel-data-part-3"
                class="hb-docs-link"
              >Using FIML in R with Multilevel Data (Part 3)</a>
            </li>
          </ul>
  
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/2022_cr2/"
    
  >Robust standard errors in mixed models
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/logistic-regression-fisher-scoring/"
    
  >Logistic regression from scratch (Newton Raphson and Fisher Scoring)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/likelihood_2022/"
    
  >Using REML and ML for estimation
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/extracting-v-matrix/"
    
  >Extracting the V matrix for MLMs
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/gee/"
    
  >🎉 Analyzing clustered data using GEEs
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/ml/"
    
  >🎉 Using maximum likelihood
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/compare/"
    
  >🎉 Comparing coefficients across logistic regression models
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/prior-problem-behavior-and-suspensions-a-replication/"
    
  >Prior problem behavior and suspensions: A replication
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/mdata/"
    
  >🎉 Using FIML and MI in R
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/applied/"
    
  >🎉 Applied example for alternatives to logistic regression
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/pca_2020/"
    
  >🎉 Principal Components Analysis using R
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/centering/"
    
  >🎉 Why does centering reduce multicollinearity?
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/poisson-and-negative-binomial-regression-using-r/"
    
  >Poisson and Negative Binomial Regression using R
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/sim2data/"
    
  >🎉 Simulating two level data
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/2018-06-16-difference-between-variance-covariance-and-correlation-matrix/"
    
  >🧠 Difference between correlation and covariance matrices
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/iv2/2018-08-17-instrumental-variables-within-a-sem-framework/"
    
  >Instrumental variables within an SEM framework
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/se/"
    
  >🎉 Class Example- Standard Errors Too Small
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/iv/"
    
  >🎉 Understanding instrumental variables
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/post/ovb/"
    
  >Omitted Variable Bias (OVB) Example
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/mlmusingr/"
    
  >
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/r/"
    
  >
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/service/"
    
  >
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/"
    
  >Projects
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/uva/"
    
  >Youth Violence Project @ UVA
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/av/"
    
  >MO Prison Transformation Project
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/project/mpsi/"
    
  >Missouri Prevention Science Institute
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/projects/"
    
  >Projects
    </a></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/"
    
  >Recent &amp; Upcoming Talks
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/example/"
    
  >Replication studies using secondary and nonexperimental datasets
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/mlm_ph/"
    
  >Multilevel Modeling with Large-Scale International Databases Using HLM (Philadelphia)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/event/korea_23/"
    
  >Using cluster robust standard errors to analyze nested data with a few clusters (Korea)
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/teaching/"
    
  >Teaching
        <span data-hb-sidebar-toggle>
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-[18px] min-w-[18px] rounded-sm p-0.5 hover:bg-gray-800/5 dark:hover:bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="origin-center transition-transform rtl:-rotate-180"></path></svg>
        </span>
    </a><div class="ltr:pr-0 overflow-hidden">
        <ul class="hb-sidebar-list"><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/teaching/dm/"
    
  >Data Management (using R)
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/teaching/mcsim/"
    
  >Monte Carlo Simulation
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/teaching/mlm/"
    
  >Multilevel Modeling
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/teaching/eval/"
    
  >Program Evaluation
    </a>
              
            </li><li class="flex flex-col "><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/teaching/quantfound/"
    
  >Quantitative Foundations
    </a>
              
            </li></ul>
      </div></li>
        <li class=""><a
    class="hb-sidebar-custom-link
      text-gray-500 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-300 dark:hover:bg-primary-800 dark:hover:text-gray-50"
    href="/experience/"
    
  >Experience
    </a></li>
    </ul>

    <div class="max-xl:hidden h-0 w-64 shrink-0"></div></div>

</aside>
  

<nav class="hb-toc order-last hidden w-64 shrink-0 xl:block print:hidden px-4" aria-label="table of contents">
  











  <div class="hb-scrollbar text-sm [hyphens:auto] sticky top-16 overflow-y-auto pr-4 pt-6 max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] -mr-4 rtl:-ml-4"><p class="mb-4 font-semibold tracking-tight">On this page</p><ul>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="font-semibold inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#using-fiml-in-r-with-multilevel-data-part-3">Using FIML in R with Multilevel Data (Part 3)</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#read-in-the-data">Read in the data</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-4 rtl:pr-4 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#use-lavaan-to-estimate-the-model-of-interest">Use lavaan to estimate the model of interest</a>
      </li>
      <li class="my-2 scroll-my-6 scroll-py-6">
        <a class="pl-8 rtl:pr-8 inline-block text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300 w-full break-words" href="#references">References</a>
      </li></ul>

  
  
    
    
  



    












  </div>
  </nav>


  <article class="w-full break-words flex min-h-[calc(100vh-var(--navbar-height))] min-w-0 justify-center pb-8 pr-[calc(env(safe-area-inset-right)-1.5rem)]">
    <main class="w-full min-w-0 max-w-6xl px-6 pt-4 md:px-12">

      
      <div class="mb-4">
        <div class="mt-1.5 flex items-center gap-1 overflow-hidden text-sm text-gray-500 dark:text-gray-400">
      <div class="whitespace-nowrap transition-colors min-w-[24px] overflow-hidden text-ellipsis hover:text-gray-900 dark:hover:text-gray-100">
        <a href="http://localhost:1313/post/">Posts</a>
      </div><svg class="w-3.5 shrink-0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m8.25 4.5l7.5 7.5l-7.5 7.5"/></svg><div class="whitespace-nowrap font-medium text-gray-700 dark:text-gray-100">Using FIML in R for Multilevel Data</div>
</div>

      </div>
      

      <h1 class="mt-2 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100">Using FIML in R for Multilevel Data</h1>

      <div class="mt-4 mb-16">
      <div class="text-gray-500 dark:text-gray-300 text-sm flex items-center flex-wrap gap-y-2"><span class="mr-1">Jun 1, 2022</span>
        

        
        <span class="mx-1">·</span>
        <span class="mx-1">
          8 min read
        </span>
        
        </div>

        <div class="mt-3">
          





        </div>
      </div>



      
      
      

      
      

      <div class="prose prose-slate lg:prose-xl dark:prose-invert">
        <h2 id="using-fiml-in-r-with-multilevel-data-part-3">Using FIML in R with Multilevel Data (Part 3)</h2>
<p>A recurring question that I get asked is how to use full information maximum likelihood (FIML) when performing a multiple regression analysis BUT this time, accounting for nesting or clustered data structure. For this example, I use the the <code>leadership</code> dataset in the <code>mitml</code> package (Grund et al., 2021). We&rsquo;ll also use <code>lavaan</code> (Roseel, 2012) to estimate the two-level model. The chapter of Grund et al. (2019) is available <a href="https://simongrund1.github.io/publications/2019-chap-apa/" target="_blank" rel="noopener">here</a>. We&rsquo;ll replicate the <code>Mplus</code> FIML results in Table 16.3 in the chapter and is shown below:</p>
<p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="" srcset="
               /post/mi_pt3/table_grund_hu_f0aa75ed6d78a6a3.webp 400w,
               /post/mi_pt3/table_grund_hu_bf963bf355d4e4b2.webp 760w,
               /post/mi_pt3/table_grund_hu_d949c2b383c220e8.webp 1200w"
               src="/post/mi_pt3/table_grund_hu_f0aa75ed6d78a6a3.webp"
               width="511"
               height="292"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h3 id="read-in-the-data">Read in the data</h3>
<p>As <code>lavaan</code> and <code>Mplus</code> need data in a numeric format (not factors), we have to recode a <code>factor</code> into a <code>numeric</code> variable. We inspect the dataset also for missing data:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">mitml</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">lavaan</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">sjmisc</span><span class="p">)</span> <span class="c1">#for frq</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">MLMusingR</span><span class="p">)</span> <span class="c1">#for nmiss</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span> <span class="c1">#for some data management and the pipe</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">data</span><span class="p">(</span><span class="n">leadership</span><span class="p">)</span> <span class="c1">#from the mitml package</span>
</span></span><span class="line"><span class="cl"><span class="n">MLMusingR</span><span class="o">::</span><span class="nf">nmiss</span><span class="p">(</span><span class="n">leadership</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">Percent</span> <span class="n">missing</span> <span class="n">per</span> <span class="n">variable</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">GRPID</span>  <span class="n">JOBSAT</span>   <span class="n">COHES</span> <span class="n">NEGLEAD</span>   <span class="n">WLOAD</span> 
</span></span><span class="line"><span class="cl">  <span class="mf">0.000</span>   <span class="mf">0.092</span>   <span class="mf">0.040</span>   <span class="mf">0.123</span>   <span class="mf">0.115</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Percent</span> <span class="n">complete</span> <span class="n">cases</span><span class="p">:</span> <span class="mf">0.708</span> 
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">Minimum</span><span class="p">)</span> <span class="n">number</span> <span class="n">to</span> <span class="n">impute</span><span class="p">:</span> <span class="mi">29</span> 
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">mice</span><span class="o">::</span><span class="nf">md.pattern</span><span class="p">(</span><span class="n">leadership</span><span class="p">,</span> <span class="n">rotate.names</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="plot of chunk unnamed-chunk-1" srcset="
               /post/mi_pt3/unnamed-chunk-1-1_hu_689816dd8762718c.webp 400w,
               /post/mi_pt3/unnamed-chunk-1-1_hu_59cbb56c16052742.webp 760w,
               /post/mi_pt3/unnamed-chunk-1-1_hu_2325058c725a745e.webp 1200w"
               src="/post/mi_pt3/unnamed-chunk-1-1_hu_689816dd8762718c.webp"
               width="504"
               height="504"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">    GRPID COHES JOBSAT WLOAD NEGLEAD    
</span></span><span class="line"><span class="cl">531     1     1      1     1       1   0
</span></span><span class="line"><span class="cl">53      1     1      1     1       0   1
</span></span><span class="line"><span class="cl">53      1     1      1     0       1   1
</span></span><span class="line"><span class="cl">21      1     1      1     0       0   2
</span></span><span class="line"><span class="cl">45      1     1      0     1       1   1
</span></span><span class="line"><span class="cl">9       1     1      0     1       0   2
</span></span><span class="line"><span class="cl">7       1     1      0     0       1   2
</span></span><span class="line"><span class="cl">1       1     1      0     0       0   3
</span></span><span class="line"><span class="cl">13      1     0      1     1       1   1
</span></span><span class="line"><span class="cl">7       1     0      1     1       0   2
</span></span><span class="line"><span class="cl">3       1     0      1     0       1   2
</span></span><span class="line"><span class="cl">5       1     0      0     1       1   2
</span></span><span class="line"><span class="cl">1       1     0      0     1       0   3
</span></span><span class="line"><span class="cl">1       1     0      0     0       1   3
</span></span><span class="line"><span class="cl">        0    30     69    86      92 277
</span></span></code></pre></div><p>Also, as done in the chapter, we:</p>
<ul>
<li>compute the group mean for <code>NEGLEAD</code> and use it as a predictor (level 2);</li>
<li>group mean center <code>NEGLEAD</code> and also use that as a predictor (level 1);</li>
<li>convert <code>WLOAD</code> into a binary, numeric predictor (wloadh = 1 and wloadh = 0).</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">str</span><span class="p">(</span><span class="n">leadership</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="s1">&#39;data.frame&#39;</span><span class="p">:</span>	<span class="mi">750</span> <span class="n">obs</span><span class="o">.</span> <span class="n">of</span>  <span class="mi">5</span> <span class="n">variables</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"> <span class="o">$</span> <span class="n">GRPID</span>  <span class="p">:</span> <span class="n">num</span>  <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"> <span class="o">$</span> <span class="n">JOBSAT</span> <span class="p">:</span> <span class="n">num</span>  <span class="o">-</span><span class="mf">1.717</span> <span class="mf">0.237</span> <span class="o">-</span><span class="mf">2.098</span> <span class="mf">2.933</span> <span class="mf">0.145</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"> <span class="o">$</span> <span class="n">COHES</span>  <span class="p">:</span> <span class="n">num</span>  <span class="mf">1.33</span> <span class="mf">1.33</span> <span class="mf">1.33</span> <span class="mf">1.33</span> <span class="mf">1.33</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"> <span class="o">$</span> <span class="n">NEGLEAD</span><span class="p">:</span> <span class="n">num</span>  <span class="mf">0.3128</span> <span class="o">-</span><span class="mf">1.9047</span> <span class="o">-</span><span class="mf">0.1243</span> <span class="o">-</span><span class="mf">1.2984</span> <span class="mf">0.0646</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"> <span class="o">$</span> <span class="n">WLOAD</span>  <span class="p">:</span> <span class="n">Factor</span> <span class="n">w</span><span class="o">/</span> <span class="mi">2</span> <span class="n">levels</span> <span class="s2">&#34;low&#34;</span><span class="p">,</span><span class="s2">&#34;high&#34;</span><span class="p">:</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="o">...</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># creating group means and group centered variables</span>
</span></span><span class="line"><span class="cl"><span class="n">leadership</span><span class="o">$</span><span class="n">negleadm</span> <span class="o">&lt;-</span> <span class="nf">group_mean</span><span class="p">(</span><span class="n">leadership</span><span class="o">$</span><span class="n">NEGLEAD</span><span class="p">,</span> <span class="n">leadership</span><span class="o">$</span><span class="n">GRPID</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">leadership</span><span class="o">$</span><span class="n">negleadc</span> <span class="o">&lt;-</span> <span class="nf">group_center</span><span class="p">(</span><span class="n">leadership</span><span class="o">$</span><span class="n">NEGLEAD</span><span class="p">,</span> <span class="n">leadership</span><span class="o">$</span><span class="n">GRPID</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">frq</span><span class="p">(</span><span class="n">leadership</span><span class="p">,</span> <span class="n">WLOAD</span><span class="p">)</span> <span class="c1">#this is a factor, convert</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">WLOAD &lt;categorical&gt; 
</span></span><span class="line"><span class="cl"># total N=750 valid N=664 mean=1.37 sd=0.48
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Value |   N | Raw % | Valid % | Cum. %
</span></span><span class="line"><span class="cl">--------------------------------------
</span></span><span class="line"><span class="cl">low   | 416 | 55.47 |   62.65 |  62.65
</span></span><span class="line"><span class="cl">high  | 248 | 33.07 |   37.35 | 100.00
</span></span><span class="line"><span class="cl">&lt;NA&gt;  |  86 | 11.47 |    &lt;NA&gt; |   &lt;NA&gt;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">leadership</span><span class="o">$</span><span class="n">wloadh</span> <span class="o">&lt;-</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">leadership</span><span class="o">$</span><span class="n">WLOAD</span> <span class="o">==</span> <span class="s">&#39;high&#39;</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">frq</span><span class="p">(</span><span class="n">leadership</span><span class="p">,</span> <span class="n">wloadh</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">wloadh</span> <span class="o">&lt;</span><span class="n">numeric</span><span class="o">&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># total N=750 valid N=664 mean=0.37 sd=0.48</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Value</span> <span class="o">|</span>   <span class="n">N</span> <span class="o">|</span> <span class="n">Raw</span> <span class="o">%</span> <span class="o">|</span> <span class="n">Valid</span> <span class="o">%</span> <span class="o">|</span> <span class="n">Cum</span><span class="o">.</span> <span class="o">%</span>
</span></span><span class="line"><span class="cl"><span class="o">--------------------------------------</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span> <span class="o">|</span> <span class="mi">416</span> <span class="o">|</span> <span class="mf">55.47</span> <span class="o">|</span>   <span class="mf">62.65</span> <span class="o">|</span>  <span class="mf">62.65</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span> <span class="o">|</span> <span class="mi">248</span> <span class="o">|</span> <span class="mf">33.07</span> <span class="o">|</span>   <span class="mf">37.35</span> <span class="o">|</span> <span class="mf">100.00</span>
</span></span><span class="line"><span class="cl"> <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span> <span class="o">|</span>  <span class="mi">86</span> <span class="o">|</span> <span class="mf">11.47</span> <span class="o">|</span>    <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span> <span class="o">|</span>   <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>
</span></span></code></pre></div><h3 id="use-lavaan-to-estimate-the-model-of-interest">Use <code>lavaan</code> to estimate the model of interest</h3>
<p>This first model does not account for missing data (just uses listwise deletion). Note as done in the chapter (read the chapter), we constrain the effect of <code>wload</code> to be the same across levels.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">mod</span> <span class="o">&lt;-</span> <span class="s">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s">level:1
</span></span></span><span class="line"><span class="cl"><span class="s">  JOBSAT ~ negleadc + a * wloadh #a is used to constrain to be equal
</span></span></span><span class="line"><span class="cl"><span class="s">level:2
</span></span></span><span class="line"><span class="cl"><span class="s">  JOBSAT ~ negleadm + COHES + a * wloadh
</span></span></span><span class="line"><span class="cl"><span class="s">&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Estimate models</span>
</span></span><span class="line"><span class="cl"><span class="n">m0</span> <span class="o">&lt;-</span> <span class="nf">sem</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">leadership</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">mod</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">cluster</span> <span class="o">=</span> <span class="s">&#39;GRPID&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">m0</span><span class="p">)</span> <span class="c1">#ignoring missing</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">lavaan</span> <span class="mf">0.6</span><span class="o">-</span><span class="mi">19</span> <span class="n">ended</span> <span class="n">normally</span> <span class="n">after</span> <span class="mi">33</span> <span class="n">iterations</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">Estimator</span>                                         <span class="n">ML</span>
</span></span><span class="line"><span class="cl">  <span class="n">Optimization</span> <span class="n">method</span>                           <span class="n">NLMINB</span>
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">model</span> <span class="n">parameters</span>                         <span class="mi">8</span>
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">equality</span> <span class="n">constraints</span>                     <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                                  <span class="n">Used</span>       <span class="n">Total</span>
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">observations</span>                           <span class="mi">531</span>         <span class="mi">750</span>
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">clusters</span> <span class="p">[</span><span class="n">GRPID</span><span class="p">]</span>                        <span class="mi">48</span>            
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Model</span> <span class="n">Test</span> <span class="n">User</span> <span class="n">Model</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                                                      
</span></span><span class="line"><span class="cl">  <span class="n">Test</span> <span class="n">statistic</span>                                 <span class="mf">0.033</span>
</span></span><span class="line"><span class="cl">  <span class="n">Degrees</span> <span class="n">of</span> <span class="n">freedom</span>                                 <span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">P</span><span class="o">-</span><span class="n">value</span> <span class="p">(</span><span class="n">Chi</span><span class="o">-</span><span class="n">square</span><span class="p">)</span>                           <span class="mf">0.856</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Parameter</span> <span class="n">Estimates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">Standard</span> <span class="n">errors</span>                             <span class="n">Standard</span>
</span></span><span class="line"><span class="cl">  <span class="n">Information</span>                                 <span class="n">Observed</span>
</span></span><span class="line"><span class="cl">  <span class="n">Observed</span> <span class="n">information</span> <span class="n">based</span> <span class="n">on</span>                <span class="n">Hessian</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Level</span> <span class="mi">1</span> <span class="p">[</span><span class="n">within</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Regressions</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">JOBSAT</span> <span class="o">~</span>                                            
</span></span><span class="line"><span class="cl">    <span class="n">negleadc</span>         <span class="o">-</span><span class="mf">0.476</span>    <span class="mf">0.089</span>   <span class="o">-</span><span class="mf">5.372</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>     <span class="p">(</span><span class="n">a</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.758</span>    <span class="mf">0.193</span>   <span class="o">-</span><span class="mf">3.936</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Variances</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="o">.</span><span class="n">JOBSAT</span>            <span class="mf">4.512</span>    <span class="mf">0.290</span>   <span class="mf">15.556</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Level</span> <span class="mi">2</span> <span class="p">[</span><span class="n">GRPID</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Regressions</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">JOBSAT</span> <span class="o">~</span>                                            
</span></span><span class="line"><span class="cl">    <span class="n">negleadm</span>         <span class="o">-</span><span class="mf">1.379</span>    <span class="mf">0.312</span>   <span class="o">-</span><span class="mf">4.421</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">    <span class="n">COHES</span>             <span class="mf">0.236</span>    <span class="mf">0.079</span>    <span class="mf">2.999</span>    <span class="mf">0.003</span>
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>     <span class="p">(</span><span class="n">a</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.758</span>    <span class="mf">0.193</span>   <span class="o">-</span><span class="mf">3.936</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Intercepts</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="o">.</span><span class="n">JOBSAT</span>           <span class="o">-</span><span class="mf">0.189</span>    <span class="mf">0.129</span>   <span class="o">-</span><span class="mf">1.463</span>    <span class="mf">0.144</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Variances</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="o">.</span><span class="n">JOBSAT</span>            <span class="mf">0.095</span>    <span class="mf">0.105</span>    <span class="mf">0.900</span>    <span class="mf">0.368</span>
</span></span></code></pre></div><p>The output says it uses only 531 out of 750 observations. We can use FIML to account for the missing data:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">m1</span> <span class="o">&lt;-</span> <span class="nf">sem</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">leadership</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">mod</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">missing</span> <span class="o">=</span> <span class="s">&#39;fiml&#39;</span><span class="p">,</span> <span class="n">cluster</span> <span class="o">=</span> <span class="s">&#39;GRPID&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">fixed.x</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Warning: lavaan-&gt;lav_data_full():  
</span></span><span class="line"><span class="cl">   some cases are empty and will be ignored: 692.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Warning: lavaan-&gt;lav_model_hessian():  
</span></span><span class="line"><span class="cl">   Hessian is not fully symmetric. Max diff = 
</span></span><span class="line"><span class="cl">   0.0145968188158649 (Max diag Hessian = 78.5822165206694)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Warning: lavaan-&gt;lav_model_hessian():  
</span></span><span class="line"><span class="cl">   Hessian is not fully symmetric. Max diff = 
</span></span><span class="line"><span class="cl">   0.0143185015100071 (Max diag Hessian = 80.5929458759393)
</span></span></code></pre></div><p>Note when we do it this way, we get a couple of warnings:</p>
<ol>
<li>Observation <code>692</code> will not be used. We can inspect that observation:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">leadership[692</span><span class="p">,</span><span class="n">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">    <span class="n">GRPID</span> <span class="n">JOBSAT</span> <span class="n">COHES</span> <span class="n">NEGLEAD</span> <span class="n">WLOAD</span> <span class="n">negleadm</span> <span class="n">negleadc</span> <span class="n">wloadh</span>
</span></span><span class="line"><span class="cl"><span class="mi">692</span>    <span class="mi">47</span>     <span class="n">NA</span> <span class="mf">0.569</span>      <span class="n">NA</span>  <span class="o">&lt;</span><span class="n">NA</span><span class="o">&gt;</span>   <span class="o">-</span><span class="mf">0.106</span>       <span class="n">NA</span>     <span class="n">NA</span>
</span></span></code></pre></div><p>This observation has missing values on all level-1 predictors as well as the outcome (so in this case, it drops it). Think about it: if all that you had were level-2 predictors and no level-1 predictors (and the outcome as well) for an observation, does it make sense to still include the observation in the model? Mplus does not provide that warning though.</p>
<ol start="2">
<li>Provides a warning about the Hessian matrix. This appears when we constrain results to be equal across levels (does not happen if the constraint is not there).</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">lavaan</span> <span class="mf">0.6</span><span class="o">-</span><span class="mi">19</span> <span class="n">ended</span> <span class="n">normally</span> <span class="n">after</span> <span class="mi">87</span> <span class="n">iterations</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">Estimator</span>                                         <span class="n">ML</span>
</span></span><span class="line"><span class="cl">  <span class="n">Optimization</span> <span class="n">method</span>                           <span class="n">NLMINB</span>
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">model</span> <span class="n">parameters</span>                        <span class="mi">21</span>
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">equality</span> <span class="n">constraints</span>                     <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                                  <span class="n">Used</span>       <span class="n">Total</span>
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">observations</span>                           <span class="mi">749</span>         <span class="mi">750</span>
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">clusters</span> <span class="p">[</span><span class="n">GRPID</span><span class="p">]</span>                        <span class="mi">50</span>            
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">missing</span> <span class="n">patterns</span> <span class="o">--</span> <span class="n">level</span> <span class="mi">1</span>              <span class="mi">7</span>            
</span></span><span class="line"><span class="cl">  <span class="n">Number</span> <span class="n">of</span> <span class="n">missing</span> <span class="n">patterns</span> <span class="o">--</span> <span class="n">level</span> <span class="mi">2</span>              <span class="mi">2</span>            
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Model</span> <span class="n">Test</span> <span class="n">User</span> <span class="n">Model</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                                                      
</span></span><span class="line"><span class="cl">  <span class="n">Test</span> <span class="n">statistic</span>                                 <span class="mf">0.523</span>
</span></span><span class="line"><span class="cl">  <span class="n">Degrees</span> <span class="n">of</span> <span class="n">freedom</span>                                 <span class="mi">1</span>
</span></span><span class="line"><span class="cl">  <span class="n">P</span><span class="o">-</span><span class="n">value</span> <span class="p">(</span><span class="n">Chi</span><span class="o">-</span><span class="n">square</span><span class="p">)</span>                           <span class="mf">0.470</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Parameter</span> <span class="n">Estimates</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">Standard</span> <span class="n">errors</span>                             <span class="n">Standard</span>
</span></span><span class="line"><span class="cl">  <span class="n">Information</span>                                 <span class="n">Observed</span>
</span></span><span class="line"><span class="cl">  <span class="n">Observed</span> <span class="n">information</span> <span class="n">based</span> <span class="n">on</span>                <span class="n">Hessian</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Level</span> <span class="mi">1</span> <span class="p">[</span><span class="n">within</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Regressions</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">JOBSAT</span> <span class="o">~</span>                                            
</span></span><span class="line"><span class="cl">    <span class="n">negleadc</span>         <span class="o">-</span><span class="mf">0.526</span>    <span class="mf">0.091</span>   <span class="o">-</span><span class="mf">5.784</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>     <span class="p">(</span><span class="n">a</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.863</span>    <span class="mf">0.197</span>   <span class="o">-</span><span class="mf">4.381</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Covariances</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">negleadc</span> <span class="o">~~</span>                                         
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>            <span class="mf">0.047</span>    <span class="mf">0.020</span>    <span class="mf">2.330</span>    <span class="mf">0.020</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Intercepts</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">negleadc</span>         <span class="o">-</span><span class="mf">0.026</span>    <span class="mf">0.040</span>   <span class="o">-</span><span class="mf">0.648</span>    <span class="mf">0.517</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Variances</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="o">.</span><span class="n">JOBSAT</span>            <span class="mf">4.940</span>    <span class="mf">0.283</span>   <span class="mf">17.481</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">    <span class="n">negleadc</span>          <span class="mf">1.057</span>    <span class="mf">0.059</span>   <span class="mf">18.070</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>            <span class="mf">0.230</span>    <span class="mf">0.013</span>   <span class="mf">17.517</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Level</span> <span class="mi">2</span> <span class="p">[</span><span class="n">GRPID</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Regressions</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">JOBSAT</span> <span class="o">~</span>                                            
</span></span><span class="line"><span class="cl">    <span class="n">negleadm</span>         <span class="o">-</span><span class="mf">1.491</span>    <span class="mf">0.319</span>   <span class="o">-</span><span class="mf">4.675</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">    <span class="n">COHES</span>             <span class="mf">0.237</span>    <span class="mf">0.088</span>    <span class="mf">2.686</span>    <span class="mf">0.007</span>
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>     <span class="p">(</span><span class="n">a</span><span class="p">)</span>   <span class="o">-</span><span class="mf">0.863</span>    <span class="mf">0.197</span>   <span class="o">-</span><span class="mf">4.381</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Covariances</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">negleadm</span> <span class="o">~~</span>                                         
</span></span><span class="line"><span class="cl">    <span class="n">COHES</span>            <span class="o">-</span><span class="mf">0.005</span>    <span class="mf">0.073</span>   <span class="o">-</span><span class="mf">0.068</span>    <span class="mf">0.946</span>
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>            <span class="mf">0.006</span>    <span class="mf">0.008</span>    <span class="mf">0.742</span>    <span class="mf">0.458</span>
</span></span><span class="line"><span class="cl">  <span class="n">COHES</span> <span class="o">~~</span>                                            
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>           <span class="o">-</span><span class="mf">0.043</span>    <span class="mf">0.028</span>   <span class="o">-</span><span class="mf">1.525</span>    <span class="mf">0.127</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Intercepts</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="o">.</span><span class="n">JOBSAT</span>            <span class="mf">0.291</span>    <span class="mf">0.136</span>    <span class="mf">2.142</span>    <span class="mf">0.032</span>
</span></span><span class="line"><span class="cl">    <span class="n">negleadm</span>          <span class="mf">0.028</span>    <span class="mf">0.051</span>    <span class="mf">0.549</span>    <span class="mf">0.583</span>
</span></span><span class="line"><span class="cl">    <span class="n">COHES</span>             <span class="mf">0.156</span>    <span class="mf">0.185</span>    <span class="mf">0.844</span>    <span class="mf">0.399</span>
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>            <span class="mf">0.363</span>    <span class="mf">0.021</span>   <span class="mf">17.278</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Variances</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                   <span class="n">Estimate</span>  <span class="n">Std</span><span class="o">.</span><span class="n">Err</span>  <span class="n">z</span><span class="o">-</span><span class="n">value</span>  <span class="n">P</span><span class="p">(</span><span class="o">&gt;|</span><span class="n">z</span><span class="o">|</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="o">.</span><span class="n">JOBSAT</span>            <span class="mf">0.268</span>    <span class="mf">0.128</span>    <span class="mf">2.086</span>    <span class="mf">0.037</span>
</span></span><span class="line"><span class="cl">    <span class="n">negleadm</span>          <span class="mf">0.131</span>    <span class="mf">0.026</span>    <span class="mf">5.000</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">    <span class="n">COHES</span>             <span class="mf">1.629</span>    <span class="mf">0.332</span>    <span class="mf">4.905</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl">    <span class="n">wloadh</span>            <span class="mf">0.005</span>    <span class="mf">0.004</span>    <span class="mf">1.037</span>    <span class="mf">0.300</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">parameterestimates</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">filter</span><span class="p">(</span><span class="n">lhs</span> <span class="o">==</span> <span class="s">&#39;JOBSAT&#39;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">     <span class="n">lhs</span> <span class="n">op</span>      <span class="n">rhs</span> <span class="n">block</span> <span class="n">level</span> <span class="n">label</span>    <span class="n">est</span>    <span class="n">se</span>     <span class="n">z</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span> <span class="n">JOBSAT</span>  <span class="o">~</span> <span class="n">negleadc</span>     <span class="mi">1</span>     <span class="mi">1</span>       <span class="o">-</span><span class="mf">0.526</span> <span class="mf">0.091</span> <span class="o">-</span><span class="mf">5.78</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span> <span class="n">JOBSAT</span>  <span class="o">~</span>   <span class="n">wloadh</span>     <span class="mi">1</span>     <span class="mi">1</span>     <span class="n">a</span> <span class="o">-</span><span class="mf">0.863</span> <span class="mf">0.197</span> <span class="o">-</span><span class="mf">4.38</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span> <span class="n">JOBSAT</span> <span class="o">~~</span>   <span class="n">JOBSAT</span>     <span class="mi">1</span>     <span class="mi">1</span>        <span class="mf">4.940</span> <span class="mf">0.283</span> <span class="mf">17.48</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span> <span class="n">JOBSAT</span> <span class="o">~</span><span class="mi">1</span>              <span class="mi">1</span>     <span class="mi">1</span>        <span class="mf">0.000</span> <span class="mf">0.000</span>    <span class="n">NA</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span> <span class="n">JOBSAT</span>  <span class="o">~</span> <span class="n">negleadm</span>     <span class="mi">2</span>     <span class="mi">2</span>       <span class="o">-</span><span class="mf">1.491</span> <span class="mf">0.319</span> <span class="o">-</span><span class="mf">4.67</span>
</span></span><span class="line"><span class="cl"><span class="mi">6</span> <span class="n">JOBSAT</span>  <span class="o">~</span>    <span class="n">COHES</span>     <span class="mi">2</span>     <span class="mi">2</span>        <span class="mf">0.237</span> <span class="mf">0.088</span>  <span class="mf">2.69</span>
</span></span><span class="line"><span class="cl"><span class="mi">7</span> <span class="n">JOBSAT</span>  <span class="o">~</span>   <span class="n">wloadh</span>     <span class="mi">2</span>     <span class="mi">2</span>     <span class="n">a</span> <span class="o">-</span><span class="mf">0.863</span> <span class="mf">0.197</span> <span class="o">-</span><span class="mf">4.38</span>
</span></span><span class="line"><span class="cl"><span class="mi">8</span> <span class="n">JOBSAT</span> <span class="o">~~</span>   <span class="n">JOBSAT</span>     <span class="mi">2</span>     <span class="mi">2</span>        <span class="mf">0.268</span> <span class="mf">0.128</span>  <span class="mf">2.09</span>
</span></span><span class="line"><span class="cl"><span class="mi">9</span> <span class="n">JOBSAT</span> <span class="o">~</span><span class="mi">1</span>              <span class="mi">2</span>     <span class="mi">2</span>        <span class="mf">0.291</span> <span class="mf">0.136</span>  <span class="mf">2.14</span>
</span></span><span class="line"><span class="cl">  <span class="n">pvalue</span> <span class="n">ci</span><span class="o">.</span><span class="n">lower</span> <span class="n">ci</span><span class="o">.</span><span class="n">upper</span>
</span></span><span class="line"><span class="cl"><span class="mi">1</span>  <span class="mf">0.000</span>   <span class="o">-</span><span class="mf">0.704</span>   <span class="o">-</span><span class="mf">0.348</span>
</span></span><span class="line"><span class="cl"><span class="mi">2</span>  <span class="mf">0.000</span>   <span class="o">-</span><span class="mf">1.249</span>   <span class="o">-</span><span class="mf">0.477</span>
</span></span><span class="line"><span class="cl"><span class="mi">3</span>  <span class="mf">0.000</span>    <span class="mf">4.386</span>    <span class="mf">5.494</span>
</span></span><span class="line"><span class="cl"><span class="mi">4</span>     <span class="n">NA</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>
</span></span><span class="line"><span class="cl"><span class="mi">5</span>  <span class="mf">0.000</span>   <span class="o">-</span><span class="mf">2.116</span>   <span class="o">-</span><span class="mf">0.866</span>
</span></span><span class="line"><span class="cl"><span class="mi">6</span>  <span class="mf">0.007</span>    <span class="mf">0.064</span>    <span class="mf">0.409</span>
</span></span><span class="line"><span class="cl"><span class="mi">7</span>  <span class="mf">0.000</span>   <span class="o">-</span><span class="mf">1.249</span>   <span class="o">-</span><span class="mf">0.477</span>
</span></span><span class="line"><span class="cl"><span class="mi">8</span>  <span class="mf">0.037</span>    <span class="mf">0.016</span>    <span class="mf">0.519</span>
</span></span><span class="line"><span class="cl"><span class="mi">9</span>  <span class="mf">0.032</span>    <span class="mf">0.025</span>    <span class="mf">0.557</span>
</span></span></code></pre></div><p>You can compare the results with those estimated using <code>Mplus</code>. The syntax is from the Grund et al. (2019) chapter. Results are comparable:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">MODEL RESULTS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Two-Tailed
</span></span><span class="line"><span class="cl">                Estimate       S.E.  Est./S.E.    P-Value
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Within Level
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">JOBSAT     ON
</span></span><span class="line"><span class="cl">NEGLEADC          -0.526      0.091     -5.785      0.000
</span></span><span class="line"><span class="cl">WLOADH            -0.863      0.197     -4.382      0.000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NEGLEADC WITH
</span></span><span class="line"><span class="cl">WLOADH             0.047      0.020      2.330      0.020
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Means
</span></span><span class="line"><span class="cl">NEGLEADC          -0.026      0.040     -0.648      0.517
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Variances
</span></span><span class="line"><span class="cl">NEGLEADC           1.057      0.059     18.070      0.000
</span></span><span class="line"><span class="cl">WLOADH             0.230      0.013     17.516      0.000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Residual Variances
</span></span><span class="line"><span class="cl">JOBSAT             4.940      0.283     17.481      0.000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Between Level
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">JOBSAT     ON
</span></span><span class="line"><span class="cl">NEGLEADM          -1.491      0.319     -4.675      0.000
</span></span><span class="line"><span class="cl">COHES              0.237      0.088      2.686      0.007
</span></span><span class="line"><span class="cl">WLOADH            -0.863      0.197     -4.382      0.000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">NEGLEADM WITH
</span></span><span class="line"><span class="cl">COHES             -0.005      0.073     -0.068      0.945
</span></span><span class="line"><span class="cl">WLOADH             0.006      0.008      0.742      0.458
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">COHES    WITH
</span></span><span class="line"><span class="cl">WLOADH            -0.043      0.028     -1.524      0.127
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Means
</span></span><span class="line"><span class="cl">COHES              0.156      0.185      0.844      0.399
</span></span><span class="line"><span class="cl">NEGLEADM           0.028      0.051      0.549      0.583
</span></span><span class="line"><span class="cl">WLOADH             0.363      0.021     17.278      0.000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Intercepts
</span></span><span class="line"><span class="cl">JOBSAT             0.291      0.136      2.141      0.032
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Variances
</span></span><span class="line"><span class="cl">COHES              1.629      0.332      4.905      0.000
</span></span><span class="line"><span class="cl">NEGLEADM           0.131      0.026      5.000      0.000
</span></span><span class="line"><span class="cl">WLOADH             0.005      0.004      1.037      0.300
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Residual Variances
</span></span><span class="line"><span class="cl">JOBSAT             0.268      0.128      2.086      0.037
</span></span></code></pre></div><p>Table 16.3 is shown again (so you don&rsquo;t have to scroll all the way up):</p>
<p>















<figure  >
  <div class="flex justify-center	">
    <div class="w-100" ><img alt="" srcset="
               /post/mi_pt3/table_grund_hu_f0aa75ed6d78a6a3.webp 400w,
               /post/mi_pt3/table_grund_hu_bf963bf355d4e4b2.webp 760w,
               /post/mi_pt3/table_grund_hu_d949c2b383c220e8.webp 1200w"
               src="/post/mi_pt3/table_grund_hu_f0aa75ed6d78a6a3.webp"
               width="511"
               height="292"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<p>Note though that Grund et al. prefer to use multiple imputation. In their <a href="https://simongrund1.github.io/publications/pdf/Grund_etal_2018_ORM.pdf" target="_blank" rel="noopener">Organizational Research Methods</a> article (2018), they warn against using FIML with multilevel data in some cases (see p. 127).</p>
<h4 id="references">References</h4>
<p>Grund, S., Ludtke, O., &amp; Robitzsch, A. (2019). Missing data in multilevel research. In: Humphrey, S. E. &amp; LeBreton, J. M. (Eds.), <em>Handbook for multilevel theory, measurement, and analysis</em>. Washington, DC: American Psychological Association doi: 10.1037/0000115-017</p>
<p>&ndash; END</p>

      </div>

      
  <time class="mt-12 mb-8 block text-xs text-gray-500 ltr:text-right rtl:text-left dark:text-gray-400" datetime="2022-06-01T00:00:00.000Z">
    <span>Last updated on</span>
    Jun 1, 2022</time>

      <div class="container mx-auto prose prose-slate lg:prose-xl dark:prose-invert mt-5">
        
        
  <div id="cusdis_thread"
  data-host="https://cusdis.com"
  data-app-id="999ce0c5-9bf3-489b-a340-698616f5b80a"
  data-page-id="http://localhost:1313/post/mi_pt3/"
  data-page-url="http://localhost:1313/post/mi_pt3/"
  data-page-title="Using FIML in R for Multilevel Data"
  data-theme="auto"
></div>
<script async defer src="https://cusdis.com/js/cusdis.es.js"></script>




      </div>

    </main>
  </article>
</div>

    </div>
    <div class="page-footer">
      <footer class="container mx-auto flex flex-col justify-items-center text-sm leading-6 mt-24 mb-4 text-slate-700 dark:text-slate-200">

  












  
  
  
  
  














  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by text-center">
    © 2025 Grumblesquasher. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0" rel="noopener noreferrer" target="_blank">CC BY NC SA 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-sa fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by text-center">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>

</footer>

    </div>

    
    











  </body>
</html>
